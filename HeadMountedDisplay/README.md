# ArUcoマーカー検出とリアルタイム映像配信

このPythonスクリプトは、カメラで撮影した映像からArUcoマーカーを検出し、検出されたマーカーの情報をWebSocketを通じて送信します。さらに、撮影した映像はリアルタイムでウェブサーバーを通して配信されます。Recertifと同時に使います。

## 必要条件

実行する前に、必要なライブラリがインストールされていることを確認してください。

- OpenCV
- NumPy
- PyYAML
- websocket-client
- picamera2
- libcamera
- bottle

これらは、以下のコマンドを使用してインストールできます。

```bash
pip install -r requirements.txt
```

## 使用方法

1. `calibration_data.yaml`ファイルにカメラのキャリブレーションデータ（カメラマトリックスと歪み係数）を保存します。
2. スクリプトを実行するには、ターミナルまたはコマンドプロンプトを開き、スクリプトが保存されているディレクトリに移動します。次に、以下のコマンドを実行します。

```bash
python script_name.py
```

`script_name.py`を実際のスクリプトファイル名に置き換えてください。

- calibration.py
キャリブレーション用
- get_marker_and_position_ref.py
マーカ番号と座標取得
- to_ros_to_streaming2
映像ストリーミング用

3. ブラウザを開き、`http://<ホストアドレス>:8080/`にアクセスします。`<ホストアドレス>`は、サーバーが実行されているホストのIPアドレスまたはホスト名に置き換えてください。

## コードの説明

- カメラのキャリブレーションデータをロードし、カメラとWebSocketクライアントを初期化します。
- ArUcoマーカーを検出し、マーカーごとの位置や姿勢を算出します。
- 検出されたマーカーの情報をWebSocketを通じて送信します。
- Bottleを使用してウェブサーバーを立ち上げ、リアルタイム映像をブラウザで表示できるようにします。
- サーバーが実行されている間、映像はリアルタイムで更新され続けます。

## 注意事項

- このスクリプトは、カメラが正常に機能していること、およびPythonと必要なライブラリがインストールされている環境でのみ動作します。
- 環境によっては、カメラへのアクセス許可や追加設定が必要な場合があります。